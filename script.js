const scenes = [
    {
        "id": "AVP_0005",
        "title": "AVP 0005",
        "oursNormal": "AVP_0005_Ours.mp4",
        "oursAnaglyph": "AVP_0005_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0005_Ours.mp4",
                "anaglyph": "AVP_0005_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0005_Eye2Eye.mp4",
                "anaglyph": "AVP_0005_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0005_StereoCrafter.mp4",
                "anaglyph": "AVP_0005_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0005_SVG.mp4",
                "anaglyph": "AVP_0005_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0005_m2svid.mp4",
                "anaglyph": "AVP_0005_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0022",
        "title": "AVP 0022",
        "oursNormal": "AVP_0022_Ours.mp4",
        "oursAnaglyph": "AVP_0022_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0022_Ours.mp4",
                "anaglyph": "AVP_0022_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0022_Eye2Eye.mp4",
                "anaglyph": "AVP_0022_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0022_StereoCrafter.mp4",
                "anaglyph": "AVP_0022_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0022_SVG.mp4",
                "anaglyph": "AVP_0022_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0022_m2svid.mp4",
                "anaglyph": "AVP_0022_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0029",
        "title": "AVP 0029",
        "oursNormal": "AVP_0029_Ours.mp4",
        "oursAnaglyph": "AVP_0029_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0029_Ours.mp4",
                "anaglyph": "AVP_0029_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0029_Eye2Eye.mp4",
                "anaglyph": "AVP_0029_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0029_StereoCrafter.mp4",
                "anaglyph": "AVP_0029_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0029_SVG.mp4",
                "anaglyph": "AVP_0029_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0029_m2svid.mp4",
                "anaglyph": "AVP_0029_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0040",
        "title": "AVP 0040",
        "oursNormal": "AVP_0040_Ours.mp4",
        "oursAnaglyph": "AVP_0040_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0040_Ours.mp4",
                "anaglyph": "AVP_0040_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0040_Eye2Eye.mp4",
                "anaglyph": "AVP_0040_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0040_StereoCrafter.mp4",
                "anaglyph": "AVP_0040_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0040_SVG.mp4",
                "anaglyph": "AVP_0040_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0040_m2svid.mp4",
                "anaglyph": "AVP_0040_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0042",
        "title": "AVP 0042",
        "oursNormal": "AVP_0042_Ours.mp4",
        "oursAnaglyph": "AVP_0042_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0042_Ours.mp4",
                "anaglyph": "AVP_0042_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0042_Eye2Eye.mp4",
                "anaglyph": "AVP_0042_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0042_StereoCrafter.mp4",
                "anaglyph": "AVP_0042_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0042_SVG.mp4",
                "anaglyph": "AVP_0042_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0042_m2svid.mp4",
                "anaglyph": "AVP_0042_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0047",
        "title": "AVP 0047",
        "oursNormal": "AVP_0047_Ours.mp4",
        "oursAnaglyph": "AVP_0047_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0047_Ours.mp4",
                "anaglyph": "AVP_0047_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0047_Eye2Eye.mp4",
                "anaglyph": "AVP_0047_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0047_StereoCrafter.mp4",
                "anaglyph": "AVP_0047_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0047_SVG.mp4",
                "anaglyph": "AVP_0047_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0047_m2svid.mp4",
                "anaglyph": "AVP_0047_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0102",
        "title": "AVP 0102",
        "oursNormal": "AVP_0102_Ours.mp4",
        "oursAnaglyph": "AVP_0102_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0102_Ours.mp4",
                "anaglyph": "AVP_0102_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0102_Eye2Eye.mp4",
                "anaglyph": "AVP_0102_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0102_StereoCrafter.mp4",
                "anaglyph": "AVP_0102_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0102_SVG.mp4",
                "anaglyph": "AVP_0102_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0102_m2svid.mp4",
                "anaglyph": "AVP_0102_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0104",
        "title": "AVP 0104",
        "oursNormal": "AVP_0104_Ours.mp4",
        "oursAnaglyph": "AVP_0104_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0104_Ours.mp4",
                "anaglyph": "AVP_0104_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0104_Eye2Eye.mp4",
                "anaglyph": "AVP_0104_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0104_StereoCrafter.mp4",
                "anaglyph": "AVP_0104_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0104_SVG.mp4",
                "anaglyph": "AVP_0104_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0104_m2svid.mp4",
                "anaglyph": "AVP_0104_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0106",
        "title": "AVP 0106",
        "oursNormal": "AVP_0106_Ours.mp4",
        "oursAnaglyph": "AVP_0106_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0106_Ours.mp4",
                "anaglyph": "AVP_0106_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0106_Eye2Eye.mp4",
                "anaglyph": "AVP_0106_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0106_StereoCrafter.mp4",
                "anaglyph": "AVP_0106_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0106_SVG.mp4",
                "anaglyph": "AVP_0106_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0106_m2svid.mp4",
                "anaglyph": "AVP_0106_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0108",
        "title": "AVP 0108",
        "oursNormal": "AVP_0108_Ours.mp4",
        "oursAnaglyph": "AVP_0108_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0108_Ours.mp4",
                "anaglyph": "AVP_0108_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0108_Eye2Eye.mp4",
                "anaglyph": "AVP_0108_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0108_StereoCrafter.mp4",
                "anaglyph": "AVP_0108_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0108_SVG.mp4",
                "anaglyph": "AVP_0108_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0108_m2svid.mp4",
                "anaglyph": "AVP_0108_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0111",
        "title": "AVP 0111",
        "oursNormal": "AVP_0111_Ours.mp4",
        "oursAnaglyph": "AVP_0111_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0111_Ours.mp4",
                "anaglyph": "AVP_0111_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0111_Eye2Eye.mp4",
                "anaglyph": "AVP_0111_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0111_StereoCrafter.mp4",
                "anaglyph": "AVP_0111_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0111_SVG.mp4",
                "anaglyph": "AVP_0111_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0111_m2svid.mp4",
                "anaglyph": "AVP_0111_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0121",
        "title": "AVP 0121",
        "oursNormal": "AVP_0121_Ours.mp4",
        "oursAnaglyph": "AVP_0121_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0121_Ours.mp4",
                "anaglyph": "AVP_0121_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0121_Eye2Eye.mp4",
                "anaglyph": "AVP_0121_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0121_StereoCrafter.mp4",
                "anaglyph": "AVP_0121_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0121_SVG.mp4",
                "anaglyph": "AVP_0121_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0121_m2svid.mp4",
                "anaglyph": "AVP_0121_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "AVP_0158",
        "title": "AVP 0158",
        "oursNormal": "AVP_0158_Ours.mp4",
        "oursAnaglyph": "AVP_0158_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "AVP_0158_Ours.mp4",
                "anaglyph": "AVP_0158_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "AVP_0158_Eye2Eye.mp4",
                "anaglyph": "AVP_0158_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "AVP_0158_StereoCrafter.mp4",
                "anaglyph": "AVP_0158_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "AVP_0158_SVG.mp4",
                "anaglyph": "AVP_0158_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "AVP_0158_m2svid.mp4",
                "anaglyph": "AVP_0158_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0014",
        "title": "iPhone 0014",
        "oursNormal": "iPhone_0014_Ours.mp4",
        "oursAnaglyph": "iPhone_0014_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0014_Ours.mp4",
                "anaglyph": "iPhone_0014_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0014_Eye2Eye.mp4",
                "anaglyph": "iPhone_0014_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0014_StereoCrafter.mp4",
                "anaglyph": "iPhone_0014_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0014_SVG.mp4",
                "anaglyph": "iPhone_0014_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0014_m2svid.mp4",
                "anaglyph": "iPhone_0014_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0030",
        "title": "iPhone 0030",
        "oursNormal": "iPhone_0030_Ours.mp4",
        "oursAnaglyph": "iPhone_0030_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0030_Ours.mp4",
                "anaglyph": "iPhone_0030_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0030_Eye2Eye.mp4",
                "anaglyph": "iPhone_0030_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0030_StereoCrafter.mp4",
                "anaglyph": "iPhone_0030_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0030_SVG.mp4",
                "anaglyph": "iPhone_0030_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0030_m2svid.mp4",
                "anaglyph": "iPhone_0030_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0049",
        "title": "iPhone 0049",
        "oursNormal": "iPhone_0049_Ours.mp4",
        "oursAnaglyph": "iPhone_0049_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0049_Ours.mp4",
                "anaglyph": "iPhone_0049_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0049_Eye2Eye.mp4",
                "anaglyph": "iPhone_0049_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0049_StereoCrafter.mp4",
                "anaglyph": "iPhone_0049_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0049_SVG.mp4",
                "anaglyph": "iPhone_0049_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0049_m2svid.mp4",
                "anaglyph": "iPhone_0049_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0052",
        "title": "iPhone 0052",
        "oursNormal": "iPhone_0052_Ours.mp4",
        "oursAnaglyph": "iPhone_0052_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0052_Ours.mp4",
                "anaglyph": "iPhone_0052_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0052_Eye2Eye.mp4",
                "anaglyph": "iPhone_0052_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0052_StereoCrafter.mp4",
                "anaglyph": "iPhone_0052_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0052_SVG.mp4",
                "anaglyph": "iPhone_0052_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0052_m2svid.mp4",
                "anaglyph": "iPhone_0052_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0055",
        "title": "iPhone 0055",
        "oursNormal": "iPhone_0055_Ours.mp4",
        "oursAnaglyph": "iPhone_0055_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0055_Ours.mp4",
                "anaglyph": "iPhone_0055_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0055_Eye2Eye.mp4",
                "anaglyph": "iPhone_0055_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0055_StereoCrafter.mp4",
                "anaglyph": "iPhone_0055_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0055_SVG.mp4",
                "anaglyph": "iPhone_0055_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0055_m2svid.mp4",
                "anaglyph": "iPhone_0055_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0056",
        "title": "iPhone 0056",
        "oursNormal": "iPhone_0056_Ours.mp4",
        "oursAnaglyph": "iPhone_0056_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0056_Ours.mp4",
                "anaglyph": "iPhone_0056_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0056_Eye2Eye.mp4",
                "anaglyph": "iPhone_0056_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0056_StereoCrafter.mp4",
                "anaglyph": "iPhone_0056_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0056_SVG.mp4",
                "anaglyph": "iPhone_0056_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0056_m2svid.mp4",
                "anaglyph": "iPhone_0056_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0070",
        "title": "iPhone 0070",
        "oursNormal": "iPhone_0070_Ours.mp4",
        "oursAnaglyph": "iPhone_0070_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0070_Ours.mp4",
                "anaglyph": "iPhone_0070_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0070_Eye2Eye.mp4",
                "anaglyph": "iPhone_0070_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0070_StereoCrafter.mp4",
                "anaglyph": "iPhone_0070_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0070_SVG.mp4",
                "anaglyph": "iPhone_0070_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0070_m2svid.mp4",
                "anaglyph": "iPhone_0070_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0082",
        "title": "iPhone 0082",
        "oursNormal": "iPhone_0082_Ours.mp4",
        "oursAnaglyph": "iPhone_0082_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0082_Ours.mp4",
                "anaglyph": "iPhone_0082_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0082_Eye2Eye.mp4",
                "anaglyph": "iPhone_0082_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0082_StereoCrafter.mp4",
                "anaglyph": "iPhone_0082_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0082_SVG.mp4",
                "anaglyph": "iPhone_0082_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0082_m2svid.mp4",
                "anaglyph": "iPhone_0082_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0093",
        "title": "iPhone 0093",
        "oursNormal": "iPhone_0093_Ours.mp4",
        "oursAnaglyph": "iPhone_0093_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0093_Ours.mp4",
                "anaglyph": "iPhone_0093_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0093_Eye2Eye.mp4",
                "anaglyph": "iPhone_0093_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0093_StereoCrafter.mp4",
                "anaglyph": "iPhone_0093_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0093_SVG.mp4",
                "anaglyph": "iPhone_0093_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0093_m2svid.mp4",
                "anaglyph": "iPhone_0093_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0115",
        "title": "iPhone 0115",
        "oursNormal": "iPhone_0115_Ours.mp4",
        "oursAnaglyph": "iPhone_0115_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0115_Ours.mp4",
                "anaglyph": "iPhone_0115_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0115_Eye2Eye.mp4",
                "anaglyph": "iPhone_0115_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0115_StereoCrafter.mp4",
                "anaglyph": "iPhone_0115_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0115_SVG.mp4",
                "anaglyph": "iPhone_0115_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0115_m2svid.mp4",
                "anaglyph": "iPhone_0115_m2svid_anaglyph.mp4"
            }
        ]
    },
    {
        "id": "iPhone_0130",
        "title": "iPhone 0130",
        "oursNormal": "iPhone_0130_Ours.mp4",
        "oursAnaglyph": "iPhone_0130_Ours_anaglyph.mp4",
        "methods": [
            {
                "name": "Ours",
                "normal": "iPhone_0130_Ours.mp4",
                "anaglyph": "iPhone_0130_Ours_anaglyph.mp4"
            },
            {
                "name": "Eye2Eye",
                "normal": "iPhone_0130_Eye2Eye.mp4",
                "anaglyph": "iPhone_0130_Eye2Eye_anaglyph.mp4"
            },
            {
                "name": "StereoCrafter",
                "normal": "iPhone_0130_StereoCrafter.mp4",
                "anaglyph": "iPhone_0130_StereoCrafter_anaglyph.mp4"
            },
            {
                "name": "SVG",
                "normal": "iPhone_0130_SVG.mp4",
                "anaglyph": "iPhone_0130_SVG_anaglyph.mp4"
            },
            {
                "name": "M2SVid",
                "normal": "iPhone_0130_m2svid.mp4",
                "anaglyph": "iPhone_0130_m2svid_anaglyph.mp4"
            }
        ]
    }
];

// --- 1. Data Pre-processing: Reorder Methods (StereoCrafter -> Index 1) ---
scenes.forEach(scene => {
    // Finding StereoCrafter
    const scIndex = scene.methods.findIndex(m => m.name === "StereoCrafter");
    // Ensure we have methods and Ours is at 0. Move SC to 1.
    if (scIndex > 1) { // If it's at 0 (Ours) or 1 (already there), leave it.
        const [sc] = scene.methods.splice(scIndex, 1);
        scene.methods.splice(1, 0, sc);
    }
});

const gallery = document.getElementById('video-gallery');
let activeSceneIndex = 0;
let currentSyncInterval = null;

// --- 2. Carousel Rendering ---
// --- 2. Carousel Rendering ---
// --- 2. Carousel Rendering (Persistent DOM) ---

let carouselCards = []; // Store references to card elements

function initCarousel() {
    gallery.innerHTML = '';

    // Container for Carousel layout
    const wrapper = document.createElement('div');
    wrapper.className = 'carousel-container';

    // Track for all cards
    const track = document.createElement('div');
    track.className = 'carousel-track';

    // Render ALL scenes as cards
    scenes.forEach((scene, index) => {
        let currentMethodIndex = 1;
        if (scene.methods.length <= 1) currentMethodIndex = 0;
        const defaultCompetitor = scene.methods[currentMethodIndex];

        const card = document.createElement('div');
        card.className = 'video-card carousel-card hidden'; // Start hidden
        card.dataset.index = index;
        card.dataset.sceneId = scene.id;

        // Interactive Controls
        const controlsHtml = scene.methods.map((method, idx) => {
            if (method.name === 'Ours') return '';
            return `<button class="method-btn ${idx === currentMethodIndex ? 'active' : ''}" data-index="${idx}">${method.name}</button>`;
        }).join('');

        card.innerHTML = `
            <div class="video-wrapper">
                 <div class="card-overlay"></div>
                 
                <!-- Layer 1: Ours Right View -->
                <video class="layer-ours-rv" loop muted playsinline poster="" preload="none">
                    <source data-src="assets/videos/${scene.oursNormal}" type="video/mp4">
                </video>
                
                <!-- Layer 2: Competitor Right View -->
                <video class="layer-comp-rv" loop muted playsinline poster="" preload="none">
                    <source data-src="assets/videos/${defaultCompetitor.normal}" type="video/mp4">
                </video>

                <!-- Layer 3: Ours Anaglyph -->
                <video class="layer-ours-ana" loop muted playsinline poster="" preload="none">
                    <source data-src="assets/videos/${scene.oursAnaglyph}" type="video/mp4">
                </video>

                <!-- Layer 4: Competitor Anaglyph -->
                <video class="layer-comp-ana" loop muted playsinline poster="" preload="none">
                    <source data-src="assets/videos/${defaultCompetitor.anaglyph}" type="video/mp4">
                </video>

                <!-- Placeholder Image & Text -->
                <img class="video-placeholder" src="assets/thumbnails/videos/${scene.oursNormal.replace('.mp4', '.jpg')}" alt="Loading...">
                <div class="loading-overlay">Loading...</div>

                <!-- Slider UI -->
                <div class="slider-line"></div>
                <div class="slider-line-h"></div>
                <div class="slider-label tl">Ours (Right View)</div>
                <div class="slider-label tr method-label">${defaultCompetitor.name} (Right View)</div>
                <div class="slider-label bl">Ours (Anaglyph)</div>
                <div class="slider-label br method-label">${defaultCompetitor.name} (Anaglyph)</div>
            </div>
            <div class="video-controls">
                ${controlsHtml}
            </div>
            <div class="video-info">
                <h4 class="video-title">${scene.title} (${index + 1} / ${scenes.length})</h4>
            </div>
        `;

        // Click on neighbor validation
        card.addEventListener('click', (e) => {
            // Only navigate if clicking on a neighbor (not active)
            // But interactive logic might stopPropagation, so check class
            if (!card.classList.contains('active')) {
                activeSceneIndex = index;
                updateCarousel();
            }
        });

        // Initialize Internal Logic (Slider, etc.)
        setupInteractiveLogic(card, scene, currentMethodIndex);

        // Placeholder Fade Logic for Gallery
        const mainVideo = card.querySelector('.layer-ours-rv');
        const placeholder = card.querySelector('.video-placeholder');
        const loader = card.querySelector('.loading-overlay');

        const handlePlaceholder = () => {
            placeholder.classList.add('fade-out');
            loader.classList.add('fade-out');
        };
        mainVideo.addEventListener('loadeddata', handlePlaceholder);
        mainVideo.addEventListener('canplay', handlePlaceholder);
        if (mainVideo.readyState >= 3) handlePlaceholder();

        track.appendChild(card);
        carouselCards.push(card);
    });

    // Helper to create buttons (UPDATED ICONS)
    const createNavButton = (cls, label, pathD) => {
        const btn = document.createElement('button');
        btn.className = `carousel-nav ${cls}`;
        btn.setAttribute('aria-label', label);
        // Larger clearer arrows
        btn.innerHTML = `
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    ${pathD}
                </svg>
            `;
        return btn;
    };

    const prevBtn = createNavButton('prev-btn', 'Previous Video', '<line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline>');
    const nextBtn = createNavButton('next-btn', 'Next Video', '<line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline>');

    // Add direct buttons to specific scenes if needed (Pills)
    prevBtn.onclick = () => {
        activeSceneIndex = (activeSceneIndex - 1 + scenes.length) % scenes.length;
        updateCarousel();
    };

    nextBtn.onclick = () => {
        activeSceneIndex = (activeSceneIndex + 1) % scenes.length;
        updateCarousel();
    };

    wrapper.appendChild(prevBtn);
    wrapper.appendChild(track);
    wrapper.appendChild(nextBtn);
    gallery.appendChild(wrapper);

    // --- Scene Selector Buttons ---
    const selectorContainer = document.createElement('div');
    selectorContainer.className = 'scene-selector';
    selectorContainer.style.display = 'flex';
    selectorContainer.style.flexWrap = 'wrap';
    selectorContainer.style.justifyContent = 'center';
    selectorContainer.style.gap = '0.5rem';
    selectorContainer.style.marginTop = '1.5rem';

    scenes.forEach((scene, index) => {
        const btn = document.createElement('button');
        btn.className = 'method-btn scene-btn'; // Use method-btn style + custom class
        btn.textContent = scene.title || scene.id;
        btn.dataset.index = index;

        btn.onclick = () => {
            activeSceneIndex = index;
            updateCarousel();
        };
        selectorContainer.appendChild(btn);
    });
    gallery.appendChild(selectorContainer);

    // Initial Update
    updateCarousel();
}

function loadCardVideo(card) {
    const videos = card.querySelectorAll('video');
    videos.forEach(v => {
        const source = v.querySelector('source');
        if (source && source.dataset.src) {
            if (!source.getAttribute('src')) {
                source.src = source.dataset.src;
                v.load();
            }
        }
    });
}

function updateCarousel() {
    // Clean up sync interval from previous active card
    if (currentSyncInterval) {
        clearInterval(currentSyncInterval);
        currentSyncInterval = null;
    }

    const N = scenes.length;

    // Update Scene Buttons highlight
    const sceneBtns = document.querySelectorAll('.scene-btn');
    sceneBtns.forEach((btn, idx) => {
        if (idx === activeSceneIndex) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });

    carouselCards.forEach((card, index) => {
        // Reset classes
        card.className = 'video-card carousel-card';

        // Videos in this card
        const videos = card.querySelectorAll('video');

        // Distance logic for wrapping
        // We want short paths. e.g. if Total 10, Active 0. Index 9 is "Prev" (-1).
        let diff = (index - activeSceneIndex + N) % N;
        if (diff > N / 2) diff -= N; // Normalize to [-N/2, N/2]

        if (diff === 0) {
            // Active
            card.classList.add('active');
            card.style.zIndex = 20;

            loadCardVideo(card); // LAZY LOAD

            // Play Active Videos
            videos.forEach(v => v.play().catch(() => { }));

            // Start Sync
            // We need to re-find the videos array for the *sync function* context?
            // Actually, setupInteractiveLogic attached listeners, but the Sync Interval needs to be managed globally for the ACTIVE card.
            // Let's hook into the active card's videos for syncing
            startActiveSync(card);

        } else if (diff === -1) {
            // Prev
            card.classList.add('prev');
            card.style.zIndex = 10;
            loadCardVideo(card); // LAZY LOAD
            videos.forEach(v => v.pause());
        } else if (diff === 1) {
            // Next
            card.classList.add('next');
            card.style.zIndex = 10;
            loadCardVideo(card); // LAZY LOAD
            videos.forEach(v => v.pause());
        } else {
            // Hidden
            card.classList.add('hidden');
            // Optimization: Hidden cards
            if (diff < -1) card.classList.add('hidden-left');
            if (diff > 1) card.classList.add('hidden-right');

            card.style.zIndex = 0;
            videos.forEach(v => v.pause());
        }
    });
}

function startActiveSync(card) {
    const videos = [
        card.querySelector('.layer-ours-rv'),
        card.querySelector('.layer-comp-rv'),
        card.querySelector('.layer-ours-ana'),
        card.querySelector('.layer-comp-ana')
    ];

    currentSyncInterval = setInterval(() => {
        const t = videos[0].currentTime;
        for (let i = 1; i < videos.length; i++) {
            if (Math.abs(videos[i].currentTime - t) > 0.1) {
                videos[i].currentTime = t;
            }
        }
    }, 500);
}

// --- 3. Logic & Interaction ---
function setupInteractiveLogic(card, scene, initialMethodIndex) {
    let currentMethodIndex = initialMethodIndex;
    const wrapper = card.querySelector('.video-wrapper');
    const videos = [
        card.querySelector('.layer-ours-rv'),
        card.querySelector('.layer-comp-rv'),
        card.querySelector('.layer-ours-ana'),
        card.querySelector('.layer-comp-ana')
    ];
    const labels = card.querySelectorAll('.method-label');
    const buttons = card.querySelectorAll('.method-btn');

    // Sync Function (Kept for internal reference, but mainly used by startActiveSync now)
    // Actually, interactive hover/slider doesn't need to start/stop sync anymore? 
    // Wait, the original logic had sync running constantly? 
    // Our new startActiveSync runs it globally for the active card. 
    // So we can remove the interval logic from here.

    // Slider Interaction
    wrapper.addEventListener('mousemove', (e) => {
        const rect = wrapper.getBoundingClientRect();

        // Account for CSS transform scaling
        const scaleX = rect.width / wrapper.offsetWidth;
        const scaleY = rect.height / wrapper.offsetHeight;

        // Get relative coordinates in unscaled space
        const x = Math.max(0, Math.min((e.clientX - rect.left) / scaleX, wrapper.offsetWidth));
        const y = Math.max(0, Math.min((e.clientY - rect.top) / scaleY, wrapper.offsetHeight));

        wrapper.style.setProperty('--x', `${x}px`);
        wrapper.style.setProperty('--y', `${y}px`);
    });

    // Touch Support for Slider
    wrapper.addEventListener('touchmove', (e) => {
        // Prevent default scrolling interacting with the slider
        if (e.cancelable) e.preventDefault();

        const rect = wrapper.getBoundingClientRect();
        // Use the first touch point
        const touch = e.touches[0];

        const scaleX = rect.width / wrapper.offsetWidth;
        const scaleY = rect.height / wrapper.offsetHeight;

        const x = Math.max(0, Math.min((touch.clientX - rect.left) / scaleX, wrapper.offsetWidth));
        const y = Math.max(0, Math.min((touch.clientY - rect.top) / scaleY, wrapper.offsetHeight));

        wrapper.style.setProperty('--x', `${x}px`);
        wrapper.style.setProperty('--y', `${y}px`);
    }, { passive: false });

    // Method Switching
    buttons.forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const idx = parseInt(btn.dataset.index);
            if (idx === currentMethodIndex) return;

            buttons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentMethodIndex = idx;

            const newMethod = scene.methods[idx];
            const t = videos[0].currentTime;

            // Update Competitor Layers (Index 1 and 3)
            const compRV = videos[1];
            const compAna = videos[3];

            compRV.src = `assets/videos/${newMethod.normal}`;
            compRV.currentTime = t;

            compAna.src = `assets/videos/${newMethod.anaglyph}`;
            compAna.currentTime = t;

            // Update Labels
            labels.forEach(l => {
                const suffix = l.textContent.includes('Anaglyph') ? '(Anaglyph)' : '(Right View)';
                l.textContent = `${newMethod.name} ${suffix}`;
            });

            if (!videos[0].paused) {
                compRV.play();
                compAna.play();
            }
        });
    });
}

// Initial Render
initCarousel();

// --- 4. Swipe Logic Helper ---
function initSwipe(element) {
    let touchStartX = 0;
    let touchEndX = 0;
    const minSwipeDistance = 50; // px

    element.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
    }, { passive: true });

    element.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
    }, { passive: true });

    function handleSwipe() {
        const distance = touchEndX - touchStartX;

        if (Math.abs(distance) > minSwipeDistance) {
            if (distance > 0) {
                // Swipe Right -> Prev
                activeSceneIndex = (activeSceneIndex - 1 + scenes.length) % scenes.length;
                updateCarousel();
            } else {
                // Swipe Left -> Next
                activeSceneIndex = (activeSceneIndex + 1) % scenes.length;
                updateCarousel();
            }
        }
    }
}

// --- 5. Showcase Carousel Rendering ---
// Interleaved Order: Disney, Bikes, Alice, Bikes...
const showcaseVideos = [
    { id: 'bikes1_3px', label: 'FPV Bikes 1' },
    { id: 'alice1_2px', label: 'Alice 1' },
    { id: 'disney2_10px', label: 'Disney 2' },
    { id: 'bikes2_1px', label: 'FPV Bikes 2' },
    { id: 'disney1_3px', label: 'Disney 1 (3px)' },
    { id: 'bikes3_8px', label: 'FPV Bikes 3' },
    { id: 'alice3_0.25px', label: 'Alice 3' },
    { id: 'bikes4_8px', label: 'FPV Bikes 4' },
    { id: 'alice5', label: 'Alice 5 (10px)' }
];

// ... (existing code for Showcase) ...

// --- 7. Features Carousel (Conditioning) ---
const featuresVideos = [
    { id: 'FPV_bikes1_elastic_zoom_overlay_lossless', label: 'FPV Bikes 1' },
    { id: 'Alice1_elastic_zoom_overlay_lossless', label: 'Alice 1' },
    { id: 'Disney2_elastic_zoom_overlay_lossless', label: 'Disney 2' },
    { id: 'FPV_bikes2_elastic_zoom_overlay_lossless', label: 'FPV Bikes 2' },
    { id: 'Disney1_elastic_zoom_overlay_lossless', label: 'Disney 1' },
    { id: 'FPV_bikes3_elastic_zoom_overlay_lossless', label: 'FPV Bikes 3' },
    { id: 'Alice3_elastic_zoom_overlay_lossless', label: 'Alice 3' },
    { id: 'FPV_bikes4_elastic_zoom_overlay_lossless', label: 'FPV Bikes 4' },
    { id: 'Alice5_elastic_zoom_overlay_lossless', label: 'Alice 5' }
];

const showcaseCarousel = document.querySelector('.showcase-carousel');

// Simple IntersectionObserver for the Showcase Carousel items
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            const videos = entry.target.querySelectorAll('video');
            videos.forEach(v => {
                // Lazy Load Logic
                const source = v.querySelector('source');
                if (source && source.dataset.src && !source.src) {
                    source.src = source.dataset.src;
                    v.load();
                }
                // Play
                if (v.paused) v.play().catch(() => { });
            });
        } else {
            const videos = entry.target.querySelectorAll('video');
            videos.forEach(v => v.pause());
        }
    });
}, { root: showcaseCarousel, threshold: 0.5 }); // Added root for better context

if (showcaseCarousel) {
    // 1. Fixed Order (Stratified) - Deterministic
    // Order: Disney 2, Bikes 1, Alice 1 ...

    // 2. Infinite Scroll: 5 Sets for robust buffer [A][B][C][D][E] center is C (Set Index 2)
    const infiniteList = [...showcaseVideos, ...showcaseVideos, ...showcaseVideos, ...showcaseVideos, ...showcaseVideos];
    const L = showcaseVideos.length;
    const initialSetStart = 2 * L;
    const initialSetEnd = 3 * L;

    // 4. Detect "Mobile" for Label Text
    const isMobile = ('ontouchstart' in window) || (window.innerWidth < 768);
    const labelText = isMobile ? 'Tap for 3D' : 'Hover for 3D';

    infiniteList.forEach((video, index) => {
        const item = document.createElement('div');
        item.className = 'showcase-item';

        // Optimize Loading: Only pre-load the middle set (Set C) which is initially visible
        // Others get data-src and lazy loaded
        const isPreload = (index >= initialSetStart && index < initialSetEnd);
        const srcAttr = isPreload ? 'src' : 'data-src';
        const autoplayAttr = isPreload ? 'autoplay' : '';

        item.innerHTML = `
            <div class="showcase-video-wrapper">
                <video class="showcase-layer input" ${autoplayAttr} loop muted playsinline preload="none">
                    <source ${srcAttr}="assets/showcase/${video.id}_input.mp4" type="video/mp4">
                </video>
                <video class="showcase-layer output" ${autoplayAttr} loop muted playsinline preload="none">
                    <source ${srcAttr}="assets/showcase/${video.id}_output.mp4" type="video/mp4">
                </video>
                <img class="video-placeholder" src="assets/thumbnails/showcase/${video.id}_input.jpg" alt="Loading...">
                <div class="loading-overlay">Loading...</div>
                <div class="showcase-label">${labelText}</div>
            </div>
        `;

        // Fade out placeholder when video triggers loadeddata
        const inputVid = item.querySelector('.showcase-layer.input');
        const placeholder = item.querySelector('.video-placeholder');
        const loader = item.querySelector('.loading-overlay');

        const handleLoad = () => {
            placeholder.classList.add('fade-out');
            loader.classList.add('fade-out');
        };

        inputVid.addEventListener('loadeddata', handleLoad);
        inputVid.addEventListener('canplay', handleLoad);
        if (inputVid.readyState >= 3) handleLoad();

        // Touch/Click support for this item
        item.addEventListener('click', (e) => {
            // Check if it was a drag or a click
            if (showcaseCarousel.classList.contains('is-dragging')) return;

            // Mark as interacted to hide label permanently
            item.classList.add('has-interacted');

            // Scroll to center logic
            // Check if element is roughly centered to decide action
            const rect = item.getBoundingClientRect();
            const carouselRect = showcaseCarousel.getBoundingClientRect();
            const centerDiff = Math.abs((rect.left + rect.width / 2) - (carouselRect.left + carouselRect.width / 2));

            if (centerDiff > 50) {
                // It is NOT centered (it's a neighbor) -> Just scroll to it
                item.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                // Do NOT toggle active (3D)
            } else {
                // It IS centered -> Toggle 3D
                item.classList.toggle('active');
            }
        });

        // Also add mouseenter to hide label on desktop hover
        item.addEventListener('mouseenter', () => {
            item.classList.add('has-interacted');
        });

        // Lazy load observer
        observer.observe(item);

        showcaseCarousel.appendChild(item);
    });

    // Scroll to middle set initially to allow scrolling both ways (simulated)
    // Small timeout to allow render
    setTimeout(() => {
        const itemWidth = showcaseCarousel.children[0].offsetWidth + 24; // Width + Gap (approx)
        const setWidth = itemWidth * showcaseVideos.length;

        // Initial Center Position: Set 2
        showcaseCarousel.scrollLeft = 2 * setWidth;

        // --- Infinite Scroll Loop Logic ---
        showcaseCarousel.addEventListener('scroll', () => {
            if (isDown) return; // Don't teleport while dragging (avoids jitter)

            const currentScroll = showcaseCarousel.scrollLeft;

            // Loop Thresholds
            // We have 3 sets: [A][B][C]
            // We are in B. If we go < B_start (which is setWidth), we are in A.
            // If we go >= C_start (which is 2 * setWidth), we are in C.

            if (currentScroll < setWidth) {
                showcaseCarousel.scrollLeft += setWidth;
            } else if (currentScroll > 3.5 * setWidth) {
                showcaseCarousel.scrollLeft -= setWidth;
            }
        });
        // --- Navigation Buttons ---
        const prevBtn = document.querySelector('.carousel-nav.prev');
        const nextBtn = document.querySelector('.carousel-nav.next');

        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                showcaseCarousel.scrollBy({ left: -itemWidth, behavior: 'smooth' });
            });
        }

        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                showcaseCarousel.scrollBy({ left: itemWidth, behavior: 'smooth' });
            });
        }
    }, 100);

    // --- Drag to Scroll Logic ---
    let startX;
    let scrollLeft;
    let isDragging = false;

    showcaseCarousel.addEventListener('mousedown', (e) => {
        isDown = true;
        isDragging = false; // Reset drag flag
        showcaseCarousel.classList.add('active');
        showcaseCarousel.style.cursor = 'grabbing';
        // Disable scroll snap for smooth dragging
        showcaseCarousel.style.scrollSnapType = 'none';

        startX = e.pageX - showcaseCarousel.offsetLeft;
        scrollLeft = showcaseCarousel.scrollLeft;
        e.preventDefault();
    });

    const stopDrag = () => {
        isDown = false;
        showcaseCarousel.classList.remove('active');
        showcaseCarousel.style.cursor = 'grab';
        // Re-enable scroll snap to settle
        showcaseCarousel.style.scrollSnapType = 'x mandatory';

        // Short timeout to clear the dragging flag so click event can fire if needed
        setTimeout(() => {
            showcaseCarousel.classList.remove('is-dragging');
        }, 50);
    };

    showcaseCarousel.addEventListener('mouseleave', stopDrag);
    showcaseCarousel.addEventListener('mouseup', stopDrag);

    showcaseCarousel.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - showcaseCarousel.offsetLeft;
        const walk = (x - startX) * 1.5; // Sensitivity
        showcaseCarousel.scrollLeft = scrollLeft - walk;

        // If moved significantly, mark as dragging to prevent click
        if (Math.abs(walk) > 5) {
            isDragging = true;
            showcaseCarousel.classList.add('is-dragging');
        }
    });
}

// --- 6. Random Disparity Glitch Animation ---
// Targets: Title layers, Author names, Affiliations
// --- 6. Random Disparity Glitch Animation ---
// Targets: Title layers, Author names, Affiliations, Buttons
function initGlitchEffect() {
    // We target: .title-wrapper (h1), .anaglyph-link (authors), .anaglyph-text (affiliations), .anaglyph-button
    // We query inside the interval to be safe against any dynamic updates, 
    // although currently items are static.

    setInterval(() => {
        const targets = [
            ...document.querySelectorAll('.title-wrapper'),
            ...document.querySelectorAll('.anaglyph-link'),
            ...document.querySelectorAll('.anaglyph-text'),
            ...document.querySelectorAll('.anaglyph-button')
        ];

        if (targets.length === 0) return;

        // Pick one random target or maybe two for more activity
        const randomTarget = targets[Math.floor(Math.random() * targets.length)];

        // Add a temporary class to trigger animation (simulating hover state)
        // We reuse the existing hover styles by adding a class that mimics :hover
        randomTarget.classList.add('glitch-active');

        // Remove it shortly after to snap back
        setTimeout(() => {
            randomTarget.classList.remove('glitch-active');
        }, 250); // Short "pop" duration

    }, 2000); // Trigger every 2s (slower frequency)
}

// Initialize glitch immediately to not miss it
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initGlitchEffect);
} else {
    initGlitchEffect();
}

// --- 7. Features Carousel (Conditioning) ---


const featuresCarousel = document.querySelector('.features-carousel');

if (featuresCarousel) {
    let featStartX, featScrollLeft, featIsDown = false, featIsDragging = false;
    const L_feat = featuresVideos.length;
    // Infinite buffer
    const infiniteFeat = [...featuresVideos, ...featuresVideos, ...featuresVideos, ...featuresVideos, ...featuresVideos];
    const initialFeatStart = 2 * L_feat;
    const initialFeatEnd = 3 * L_feat;

    const featObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const videos = entry.target.querySelectorAll('video');
                videos.forEach(v => {
                    const source = v.querySelector('source');
                    if (source && source.dataset.src && !source.src) {
                        source.src = source.dataset.src;
                        v.load();
                    }
                    if (v.paused) v.play().catch(() => { });
                });
            } else {
                const videos = entry.target.querySelectorAll('video');
                videos.forEach(v => v.pause());
            }
        });
    }, { root: featuresCarousel, threshold: 0.5 });

    infiniteFeat.forEach((video, index) => {
        const item = document.createElement('div');
        item.className = 'showcase-item feature-item'; // Re-use showcase-item styles

        const isPreload = (index >= initialFeatStart && index < initialFeatEnd);
        const srcAttr = isPreload ? 'src' : 'data-src';
        const autoplayAttr = isPreload ? 'autoplay' : '';

        item.innerHTML = `
            <div class="showcase-video-wrapper features-video-wrapper">
                <video class="showcase-layer" ${autoplayAttr} loop muted playsinline preload="none" style="opacity: 1;">
                    <source ${srcAttr}="assets/videos/features/${video.id}.mp4" type="video/mp4">
                </video>
                <img class="video-placeholder" src="assets/thumbnails/features/${video.id}.jpg" alt="Loading...">
                <div class="loading-overlay">Loading...</div>
            </div>
        `;

        // Handle placeholder fade out
        const vid = item.querySelector('.showcase-layer');
        const placeholder = item.querySelector('.video-placeholder');
        const loader = item.querySelector('.loading-overlay');

        const handleLoad = () => {
            placeholder.classList.add('fade-out');
            loader.classList.add('fade-out');
        };

        vid.addEventListener('loadeddata', handleLoad);
        vid.addEventListener('canplay', handleLoad);
        if (vid.readyState >= 3) handleLoad();


        item.addEventListener('click', () => {
            if (featuresCarousel.classList.contains('is-dragging')) return;
            item.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
        });

        featObserver.observe(item);
        featuresCarousel.appendChild(item);
    });

    setTimeout(() => {
        const itemWidth = featuresCarousel.children[0].offsetWidth + 24;
        const setWidth = itemWidth * L_feat;
        featuresCarousel.scrollLeft = 2 * setWidth;

        featuresCarousel.addEventListener('scroll', () => {
            if (featIsDown) return;
            const currentScroll = featuresCarousel.scrollLeft;
            if (currentScroll < setWidth) {
                featuresCarousel.scrollLeft += setWidth;
            } else if (currentScroll > 3.5 * setWidth) {
                featuresCarousel.scrollLeft -= setWidth;
            }
        });

        const prevBtn = document.querySelector('.features-carousel-container .carousel-nav.prev');
        const nextBtn = document.querySelector('.features-carousel-container .carousel-nav.next');

        if (prevBtn) prevBtn.onclick = () => featuresCarousel.scrollBy({ left: -itemWidth, behavior: 'smooth' });
        if (nextBtn) nextBtn.onclick = () => featuresCarousel.scrollBy({ left: itemWidth, behavior: 'smooth' });
    }, 100);

    featuresCarousel.addEventListener('mousedown', (e) => {
        featIsDown = true;
        featIsDragging = false;
        featuresCarousel.classList.add('active');
        featuresCarousel.style.cursor = 'grabbing';
        featuresCarousel.style.scrollSnapType = 'none';
        featStartX = e.pageX - featuresCarousel.offsetLeft;
        featScrollLeft = featuresCarousel.scrollLeft;
        e.preventDefault();
    });

    const stopFeatDrag = () => {
        featIsDown = false;
        featuresCarousel.classList.remove('active');
        featuresCarousel.style.cursor = 'grab';
        featuresCarousel.style.scrollSnapType = 'x mandatory';
        setTimeout(() => featuresCarousel.classList.remove('is-dragging'), 50);
    };

    featuresCarousel.addEventListener('mouseleave', stopFeatDrag);
    featuresCarousel.addEventListener('mouseup', stopFeatDrag);

    featuresCarousel.addEventListener('mousemove', (e) => {
        if (!featIsDown) return;
        e.preventDefault();
        const x = e.pageX - featuresCarousel.offsetLeft;
        const walk = (x - featStartX) * 1.5;
        featuresCarousel.scrollLeft = featScrollLeft - walk;
        if (Math.abs(walk) > 5) {
            featIsDragging = true;
            featuresCarousel.classList.add('is-dragging');
        }
    });
}
